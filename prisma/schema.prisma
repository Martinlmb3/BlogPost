generator client {
  provider = "prisma-client-js"
  output   = "../node_modules/.prisma/client"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model BlogPost {
  id          String     @id @default(uuid())
  title       String
  content     String
  imageUrl    String
  authorId    String
  authorName  String
  authorImage String
  likes       Int        @default(0)
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
  comments    Comment[]
  postLikes   PostLike[]
}

model Comment {
  id              String    @id @default(uuid())
  text            String
  like            Int
  dislike         Int
  authorId        String
  authorName      String
  authorImage     String
  createdAt       DateTime  @default(now())
  blogPostId      String
  blogPost        BlogPost  @relation(fields: [blogPostId], references: [id])
  parentCommentId String?
  parentComment   Comment?  @relation("CommentReplies", fields: [parentCommentId], references: [id])
  replies         Comment[] @relation("CommentReplies")
}

model PostLike {
  id         String   @id @default(uuid())
  userId     String
  blogPostId String
  createdAt  DateTime @default(now())
  blogPost   BlogPost @relation(fields: [blogPostId], references: [id], onDelete: Cascade)
  
  @@unique([userId, blogPostId])
}
